# 合同审核与确认测试手册

## 前置
- 启动后端：
  ```bash
  ~/dev/apache-maven-3.9.12/bin/mvn -f backend/pom.xml spring-boot:run
  ```
- 启动前端：
  ```bash
  cd web
  npm run dev -- --host
  ```
- 确认根目录 `.env` 包含：
  - `VITE_API_BASE_URL=http://localhost:8080`

## 用例 A：提交审核（draft → pending_approval）
1. 完成销售端合同录入并提交审核。
2. 观察浏览器控制台/网络请求。

预期结果：
- 请求 `POST /api/contracts/{id}/submit` 成功。
- 后端合同状态更新为 `pending_approval`。

## 用例 B：主管/管理员确认 + 打印
1. 使用 `admin@test.com / 123456` 登录。
2. 左侧菜单进入“合同审核”。
3. 选择一条待审核合同，点击“查看合同”。
4. 点击“打印”，确认弹出打印窗口。
5. 点击“确认”完成审核。

预期结果：
- 待审核列表减少对应合同。
- 打印窗口正常打开并可预览合同内容。
- 返回 `status=approved`。
- 触发 `muse_points_ledger` 入账记录（mock 数据不依赖真实支付）。

## 常见问题排查
- 提交审核失败：检查 `/api/contracts/{id}/submit` 是否可访问。
- 无待审核列表：检查 `/api/contracts/pending` 是否可访问，且已有提交审核的合同。
- 确认失败：检查 `/api/contracts/{id}/confirm` 是否可访问。
